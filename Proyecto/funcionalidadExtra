function fntInformeActividad {
    Clear-Host
    $basePath = "C:\GestorDocumental"
    $logPath = "$basePath\informes"
    if (-not (Test-Path $logPath)) { New-Item -Path $logPath -ItemType Directory }

    $fecha = Get-Date -Format "yyyy-MM-dd_HH-mm"
    $informe = "$logPath\informe_$fecha.txt"

    Add-Content $informe "===== INFORME DE ACTIVIDAD ====="
    Add-Content $informe "Fecha: $(Get-Date)"
    Add-Content $informe ""

    # Tamaño de carpetas (versión corregida)
    Add-Content $informe ">> Tamaño de carpetas:"
    Get-ChildItem $basePath | Where-Object { $_.PSIsContainer } | ForEach-Object {
        $archivos = Get-ChildItem $_.FullName -Recurse -File -ErrorAction SilentlyContinue
        $size = ($archivos | Measure-Object -Property Length -Sum).Sum
        $sizeMB = if ($size) { [math]::Round($size / 1MB, 2) } else { 0 }
        Add-Content $informe "$($_.Name): $sizeMB MB"
    }

    Add-Content $informe ""
    Add-Content $informe ">> Últimos accesos registrados:"
    wevtutil qe Security /q:"*[System[(EventID=4663)]]" /c:20 /f:text | Add-Content $informe

    Write-Host "Informe generado en: $informe"
}
